"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _api_grpc_web_pb = _interopRequireDefault(require("../../protogen/proto/api/api_grpc_web_pb"));

var _types = require("./types");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class RpcMethod {
  constructor(hostname, options = {}) {
    _defineProperty(this, "client", void 0);

    _defineProperty(this, "timeout", void 0);

    this.client = new _api_grpc_web_pb.default.APIServicePromiseClient(hostname, null, null);
    this.timeout = options.timeout || 300000;
  }

  setProvider(provider) {
    if (typeof provider === "string") {
      this.client = new _api_grpc_web_pb.default.APIServicePromiseClient(provider, null, null);
    } else {
      const origin = provider;
      this.client = origin.client;
    }
  }

  getDeadline() {
    return `${new Date(Date.now() + this.timeout).getTime()}`;
  }

  async getAccount(req) {
    const pbReq = _types.GetAccountRequest.to(req);

    const pbResp = await this.client.getAccount(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.GetAccountRequest.from(pbResp);
  }

  async getBlockMetas(req) {
    const pbReq = _types.GetBlockMetasRequest.to(req);

    const pbResp = await this.client.getBlockMetas(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.GetBlockMetasRequest.from(pbResp);
  }

  async getChainMeta(req) {
    const pbReq = _types.GetChainMetaRequest.to(req);

    const pbResp = await this.client.getChainMeta(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.GetChainMetaRequest.from(pbResp);
  }

  async getServerMeta(req) {
    const pbReq = _types.GetServerMetaRequest.to(req);

    const pbResp = await this.client.getServerMeta(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.GetServerMetaRequest.from(pbResp);
  }

  async getActions(req) {
    const pbReq = _types.GetActionsRequest.to(req);

    const pbResp = await this.client.getActions(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.GetActionsRequest.from(pbResp);
  }

  async suggestGasPrice(req) {
    const pbReq = _types.SuggestGasPriceRequest.to(req);

    const pbResp = await this.client.suggestGasPrice(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.SuggestGasPriceRequest.from(pbResp);
  }

  async estimateGasForAction(req) {
    const pbReq = _types.EstimateGasForActionRequest.to(req);

    const pbResp = await this.client.estimateGasForAction(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.EstimateGasForActionRequest.from(pbResp);
  }

  async readState(req) {
    const pbReq = _types.ReadStateRequest.to(req);

    const pbResp = await this.client.readState(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.ReadStateRequest.from(pbResp);
  }

  async readContract(req) {
    const pbReq = _types.ReadContractRequest.to(req);

    const pbResp = await this.client.readContract(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.ReadContractRequest.from(pbResp);
  }

  async sendAction(req) {
    const pbReq = _types.SendActionRequest.to(req);

    const pbResp = await this.client.sendAction(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.SendActionResponse.from(pbResp);
  }

  async getReceiptByAction(req) {
    const pbReq = _types.GetReceiptByActionRequest.to(req);

    const pbResp = await this.client.getReceiptByAction(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.GetReceiptByActionRequest.from(pbResp);
  }

  async getEpochMeta(req) {
    const pbReq = _types.GetEpochMetaRequest.to(req);

    const pbResp = await this.client.getEpochMeta(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.GetEpochMetaRequest.from(pbResp);
  }

  async getLogs(req) {
    const pbReq = _types.GetLogsRequest.to(req);

    const pbResp = await this.client.getLogs(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.GetLogsRequest.from(pbResp);
  }

  async estimateActionGasConsumption(req) {
    const pbReq = _types.EstimateActionGasConsumptionRequest.to(req);

    const pbResp = await this.client.estimateActionGasConsumption(pbReq, {
      deadline: this.getDeadline()
    });
    return _types.EstimateActionGasConsumptionRequest.from(pbResp);
  }

  streamBlocks(req) {
    const pbReq = _types.StreamBlocksRequest.to(req); // @ts-ignore


    const origin = this.client.streamBlocks(pbReq, {
      deadline: this.getDeadline()
    });
    return new _types.ClientReadableStream(origin, "StreamBlocks");
  }

  streamLogs(req) {
    const pbReq = _types.StreamLogsRequest.to(req); // @ts-ignore


    const origin = this.client.streamLogs(pbReq, {
      deadline: this.getDeadline()
    });
    return new _types.ClientReadableStream(origin, "StreamLogs");
  }

}

exports.default = RpcMethod;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9ycGMtbWV0aG9kL2Jyb3dzZXItcnBjLW1ldGhvZC50cyJdLCJuYW1lcyI6WyJScGNNZXRob2QiLCJjb25zdHJ1Y3RvciIsImhvc3RuYW1lIiwib3B0aW9ucyIsImNsaWVudCIsImdycGNXZWIiLCJBUElTZXJ2aWNlUHJvbWlzZUNsaWVudCIsInRpbWVvdXQiLCJzZXRQcm92aWRlciIsInByb3ZpZGVyIiwib3JpZ2luIiwiZ2V0RGVhZGxpbmUiLCJEYXRlIiwibm93IiwiZ2V0VGltZSIsImdldEFjY291bnQiLCJyZXEiLCJwYlJlcSIsIkdldEFjY291bnRSZXF1ZXN0IiwidG8iLCJwYlJlc3AiLCJkZWFkbGluZSIsImZyb20iLCJnZXRCbG9ja01ldGFzIiwiR2V0QmxvY2tNZXRhc1JlcXVlc3QiLCJnZXRDaGFpbk1ldGEiLCJHZXRDaGFpbk1ldGFSZXF1ZXN0IiwiZ2V0U2VydmVyTWV0YSIsIkdldFNlcnZlck1ldGFSZXF1ZXN0IiwiZ2V0QWN0aW9ucyIsIkdldEFjdGlvbnNSZXF1ZXN0Iiwic3VnZ2VzdEdhc1ByaWNlIiwiU3VnZ2VzdEdhc1ByaWNlUmVxdWVzdCIsImVzdGltYXRlR2FzRm9yQWN0aW9uIiwiRXN0aW1hdGVHYXNGb3JBY3Rpb25SZXF1ZXN0IiwicmVhZFN0YXRlIiwiUmVhZFN0YXRlUmVxdWVzdCIsInJlYWRDb250cmFjdCIsIlJlYWRDb250cmFjdFJlcXVlc3QiLCJzZW5kQWN0aW9uIiwiU2VuZEFjdGlvblJlcXVlc3QiLCJTZW5kQWN0aW9uUmVzcG9uc2UiLCJnZXRSZWNlaXB0QnlBY3Rpb24iLCJHZXRSZWNlaXB0QnlBY3Rpb25SZXF1ZXN0IiwiZ2V0RXBvY2hNZXRhIiwiR2V0RXBvY2hNZXRhUmVxdWVzdCIsImdldExvZ3MiLCJHZXRMb2dzUmVxdWVzdCIsImVzdGltYXRlQWN0aW9uR2FzQ29uc3VtcHRpb24iLCJFc3RpbWF0ZUFjdGlvbkdhc0NvbnN1bXB0aW9uUmVxdWVzdCIsInN0cmVhbUJsb2NrcyIsIlN0cmVhbUJsb2Nrc1JlcXVlc3QiLCJDbGllbnRSZWFkYWJsZVN0cmVhbSIsInN0cmVhbUxvZ3MiLCJTdHJlYW1Mb2dzUmVxdWVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7Ozs7QUE2RGUsTUFBTUEsU0FBTixDQUFzQztBQUluREMsRUFBQUEsV0FBVyxDQUFDQyxRQUFELEVBQW1CQyxPQUFhLEdBQUcsRUFBbkMsRUFBdUM7QUFBQTs7QUFBQTs7QUFDaEQsU0FBS0MsTUFBTCxHQUFjLElBQUlDLHlCQUFRQyx1QkFBWixDQUFvQ0osUUFBcEMsRUFBOEMsSUFBOUMsRUFBb0QsSUFBcEQsQ0FBZDtBQUNBLFNBQUtLLE9BQUwsR0FBZUosT0FBTyxDQUFDSSxPQUFSLElBQW1CLE1BQWxDO0FBQ0Q7O0FBRU1DLEVBQUFBLFdBQVAsQ0FBbUJDLFFBQW5CLEVBQXdEO0FBQ3RELFFBQUksT0FBT0EsUUFBUCxLQUFvQixRQUF4QixFQUFrQztBQUNoQyxXQUFLTCxNQUFMLEdBQWMsSUFBSUMseUJBQVFDLHVCQUFaLENBQW9DRyxRQUFwQyxFQUE4QyxJQUE5QyxFQUFvRCxJQUFwRCxDQUFkO0FBQ0QsS0FGRCxNQUVPO0FBQ0wsWUFBTUMsTUFBTSxHQUFHRCxRQUFmO0FBQ0EsV0FBS0wsTUFBTCxHQUFjTSxNQUFNLENBQUNOLE1BQXJCO0FBQ0Q7QUFDRjs7QUFFTU8sRUFBQUEsV0FBUCxHQUE2QjtBQUMzQixXQUFRLEdBQUUsSUFBSUMsSUFBSixDQUFTQSxJQUFJLENBQUNDLEdBQUwsS0FBYSxLQUFLTixPQUEzQixFQUFvQ08sT0FBcEMsRUFBOEMsRUFBeEQ7QUFDRDs7QUFFRCxRQUFhQyxVQUFiLENBQ0VDLEdBREYsRUFFZ0M7QUFDOUIsVUFBTUMsS0FBSyxHQUFHQyx5QkFBa0JDLEVBQWxCLENBQXFCSCxHQUFyQixDQUFkOztBQUNBLFVBQU1JLE1BQU0sR0FBRyxNQUFNLEtBQUtoQixNQUFMLENBQVlXLFVBQVosQ0FBdUJFLEtBQXZCLEVBQThCO0FBQ2pESSxNQUFBQSxRQUFRLEVBQUUsS0FBS1YsV0FB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Ozs7QUFDQSxVQUFNTixNQUFNLEdBQUcsS0FBS04sTUFBTCxDQUFZOEMsWUFBWixDQUF5QmpDLEtBQXpCLEVBQWdDO0FBQzdDSSxNQUFBQSxRQUFRLEVBQUUsS0FBS1YsV0FBTDtBQURtQyxLQUFoQyxDQUFmO0FBSUEsV0FBTyxJQUFJeUMsMkJBQUosQ0FBeUIxQyxNQUF6QixFQUFpQyxjQUFqQyxDQUFQO0FBQ0Q7O0FBRU0yQyxFQUFBQSxVQUFQLENBQ0VyQyxHQURGLEVBRTZDO0FBQzNDLFVBQU1DLEtBQUssR0FBR3FDLHlCQUFrQm5DLEVBQWxCLENBQXFCSCxHQUFyQixDQUFkLENBRDJDLENBRTNDOzs7QUFDQSxVQUFNTixNQUFNLEdBQUcsS0FBS04sTUFBTCxDQUFZaUQsVUFBWixDQUF1QnBDLEtBQXZCLEVBQThCO0FBQzNDSSxNQUFBQSxRQUFRLEVBQUUsS0FBS1YsV0FBTDtBQURpQyxLQUE5QixDQUFmO0FBSUEsV0FBTyxJQUFJeUMsMkJBQUosQ0FBeUIxQyxNQUF6QixFQUFpQyxZQUFqQyxDQUFQO0FBQ0Q7O0FBcExrRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBncnBjV2ViIGZyb20gXCIuLi8uLi9wcm90b2dlbi9wcm90by9hcGkvYXBpX2dycGNfd2ViX3BiXCI7XG5pbXBvcnQge1xuICBDbGllbnRSZWFkYWJsZVN0cmVhbSxcbiAgRXN0aW1hdGVBY3Rpb25HYXNDb25zdW1wdGlvblJlcXVlc3QsXG4gIEdldExvZ3NSZXF1ZXN0LFxuICBHZXRTZXJ2ZXJNZXRhUmVxdWVzdCxcbiAgSUVzdGltYXRlQWN0aW9uR2FzQ29uc3VtcHRpb25SZXF1ZXN0LFxuICBJRXN0aW1hdGVBY3Rpb25HYXNDb25zdW1wdGlvblJlc3BvbnNlLFxuICBJRXN0aW1hdGVHYXNGb3JBY3Rpb25SZXF1ZXN0LFxuICBJRXN0aW1hdGVHYXNGb3JBY3Rpb25SZXNwb25zZSxcbiAgSUdldEFjY291bnRSZXF1ZXN0LFxuICBJR2V0QWNjb3VudFJlc3BvbnNlLFxuICBJR2V0QWN0aW9uc1JlcXVlc3QsXG4gIElHZXRBY3Rpb25zUmVzcG9uc2UsXG4gIElHZXRCbG9ja01ldGFzUmVxdWVzdCxcbiAgSUdldEJsb2NrTWV0YXNSZXNwb25zZSxcbiAgSUdldENoYWluTWV0YVJlcXVlc3QsXG4gIElHZXRDaGFpbk1ldGFSZXNwb25zZSxcbiAgSUdldEVwb2NoTWV0YVJlcXVlc3QsXG4gIElHZXRFcG9jaE1ldGFSZXNwb25zZSxcbiAgSUdldExvZ3NSZXF1ZXN0LFxuICBJR2V0TG9nc1Jlc3BvbnNlLFxuICBJR2V0UmVjZWlwdEJ5QWN0aW9uUmVxdWVzdCxcbiAgSUdldFJlY2VpcHRCeUFjdGlvblJlc3BvbnNlLFxuICBJR2V0U2VydmVyTWV0YVJlcXVlc3QsXG4gIElHZXRTZXJ2ZXJNZXRhUmVzcG9uc2UsXG4gIElSZWFkQ29udHJhY3RSZXF1ZXN0LFxuICBJUmVhZENvbnRyYWN0UmVzcG9uc2UsXG4gIElSZWFkU3RhdGVSZXF1ZXN0LFxuICBJUmVhZFN0YXRlUmVzcG9uc2UsXG4gIElScGNNZXRob2QsXG4gIElTZW5kQWN0aW9uUmVxdWVzdCxcbiAgSVNlbmRBY3Rpb25SZXNwb25zZSxcbiAgSVN0cmVhbUJsb2Nrc1JlcXVlc3QsXG4gIElTdHJlYW1CbG9ja3NSZXNwb25zZSxcbiAgSVN0cmVhbUxvZ3NSZXF1ZXN0LFxuICBJU3RyZWFtTG9nc1Jlc3BvbnNlLFxuICBJU3VnZ2VzdEdhc1ByaWNlUmVxdWVzdCxcbiAgSVN1Z2dlc3RHYXNQcmljZVJlc3BvbnNlLFxuICBSZWFkU3RhdGVSZXF1ZXN0LFxuICBTZW5kQWN0aW9uUmVzcG9uc2Vcbn0gZnJvbSBcIi4vdHlwZXNcIjtcblxuaW1wb3J0IHtcbiAgRXN0aW1hdGVHYXNGb3JBY3Rpb25SZXF1ZXN0LFxuICBHZXRBY2NvdW50UmVxdWVzdCxcbiAgR2V0QWN0aW9uc1JlcXVlc3QsXG4gIEdldEJsb2NrTWV0YXNSZXF1ZXN0LFxuICBHZXRDaGFpbk1ldGFSZXF1ZXN0LFxuICBHZXRFcG9jaE1ldGFSZXF1ZXN0LFxuICBHZXRSZWNlaXB0QnlBY3Rpb25SZXF1ZXN0LFxuICBSZWFkQ29udHJhY3RSZXF1ZXN0LFxuICBTZW5kQWN0aW9uUmVxdWVzdCxcbiAgU3RyZWFtQmxvY2tzUmVxdWVzdCxcbiAgU3RyZWFtTG9nc1JlcXVlc3QsXG4gIFN1Z2dlc3RHYXNQcmljZVJlcXVlc3Rcbn0gZnJvbSBcIi4vdHlwZXNcIjtcblxudHlwZSBPcHRzID0ge1xuICB0aW1lb3V0PzogbnVtYmVyO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUnBjTWV0aG9kIGltcGxlbWVudHMgSVJwY01ldGhvZCB7XG4gIHB1YmxpYyBjbGllbnQ6IGdycGNXZWIuQVBJU2VydmljZVByb21pc2VDbGllbnQ7XG4gIHB1YmxpYyB0aW1lb3V0OiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoaG9zdG5hbWU6IHN0cmluZywgb3B0aW9uczogT3B0cyA9IHt9KSB7XG4gICAgdGhpcy5jbGllbnQgPSBuZXcgZ3JwY1dlYi5BUElTZXJ2aWNlUHJvbWlzZUNsaWVudChob3N0bmFtZSwgbnVsbCwgbnVsbCk7XG4gICAgdGhpcy50aW1lb3V0ID0gb3B0aW9ucy50aW1lb3V0IHx8IDMwMDAwMDtcbiAgfVxuXG4gIHB1YmxpYyBzZXRQcm92aWRlcihwcm92aWRlcjogc3RyaW5nIHwgSVJwY01ldGhvZCk6IHZvaWQge1xuICAgIGlmICh0eXBlb2YgcHJvdmlkZXIgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHRoaXMuY2xpZW50ID0gbmV3IGdycGNXZWIuQVBJU2VydmljZVByb21pc2VDbGllbnQocHJvdmlkZXIsIG51bGwsIG51bGwpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBvcmlnaW4gPSBwcm92aWRlciBhcyBScGNNZXRob2Q7XG4gICAgICB0aGlzLmNsaWVudCA9IG9yaWdpbi5jbGllbnQ7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGdldERlYWRsaW5lKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke25ldyBEYXRlKERhdGUubm93KCkgKyB0aGlzLnRpbWVvdXQpLmdldFRpbWUoKX1gO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldEFjY291bnQoXG4gICAgcmVxOiBJR2V0QWNjb3VudFJlcXVlc3RcbiAgKTogUHJvbWlzZTxJR2V0QWNjb3VudFJlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBHZXRBY2NvdW50UmVxdWVzdC50byhyZXEpO1xuICAgIGNvbnN0IHBiUmVzcCA9IGF3YWl0IHRoaXMuY2xpZW50LmdldEFjY291bnQocGJSZXEsIHtcbiAgICAgIGRlYWRsaW5lOiB0aGlzLmdldERlYWRsaW5lKClcbiAgICB9KTtcbiAgICByZXR1cm4gR2V0QWNjb3VudFJlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldEJsb2NrTWV0YXMoXG4gICAgcmVxOiBJR2V0QmxvY2tNZXRhc1JlcXVlc3RcbiAgKTogUHJvbWlzZTxJR2V0QmxvY2tNZXRhc1Jlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBHZXRCbG9ja01ldGFzUmVxdWVzdC50byhyZXEpO1xuICAgIGNvbnN0IHBiUmVzcCA9IGF3YWl0IHRoaXMuY2xpZW50LmdldEJsb2NrTWV0YXMocGJSZXEsIHtcbiAgICAgIGRlYWRsaW5lOiB0aGlzLmdldERlYWRsaW5lKClcbiAgICB9KTtcbiAgICByZXR1cm4gR2V0QmxvY2tNZXRhc1JlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldENoYWluTWV0YShcbiAgICByZXE6IElHZXRDaGFpbk1ldGFSZXF1ZXN0XG4gICk6IFByb21pc2U8SUdldENoYWluTWV0YVJlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBHZXRDaGFpbk1ldGFSZXF1ZXN0LnRvKHJlcSk7XG4gICAgY29uc3QgcGJSZXNwID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0Q2hhaW5NZXRhKHBiUmVxLCB7XG4gICAgICBkZWFkbGluZTogdGhpcy5nZXREZWFkbGluZSgpXG4gICAgfSk7XG4gICAgcmV0dXJuIEdldENoYWluTWV0YVJlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldFNlcnZlck1ldGEoXG4gICAgcmVxOiBJR2V0U2VydmVyTWV0YVJlcXVlc3RcbiAgKTogUHJvbWlzZTxJR2V0U2VydmVyTWV0YVJlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBHZXRTZXJ2ZXJNZXRhUmVxdWVzdC50byhyZXEpO1xuICAgIGNvbnN0IHBiUmVzcCA9IGF3YWl0IHRoaXMuY2xpZW50LmdldFNlcnZlck1ldGEocGJSZXEsIHtcbiAgICAgIGRlYWRsaW5lOiB0aGlzLmdldERlYWRsaW5lKClcbiAgICB9KTtcbiAgICByZXR1cm4gR2V0U2VydmVyTWV0YVJlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldEFjdGlvbnMoXG4gICAgcmVxOiBJR2V0QWN0aW9uc1JlcXVlc3RcbiAgKTogUHJvbWlzZTxJR2V0QWN0aW9uc1Jlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBHZXRBY3Rpb25zUmVxdWVzdC50byhyZXEpO1xuICAgIGNvbnN0IHBiUmVzcCA9IGF3YWl0IHRoaXMuY2xpZW50LmdldEFjdGlvbnMocGJSZXEsIHtcbiAgICAgIGRlYWRsaW5lOiB0aGlzLmdldERlYWRsaW5lKClcbiAgICB9KTtcbiAgICByZXR1cm4gR2V0QWN0aW9uc1JlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHN1Z2dlc3RHYXNQcmljZShcbiAgICByZXE6IElTdWdnZXN0R2FzUHJpY2VSZXF1ZXN0XG4gICk6IFByb21pc2U8SVN1Z2dlc3RHYXNQcmljZVJlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBTdWdnZXN0R2FzUHJpY2VSZXF1ZXN0LnRvKHJlcSk7XG4gICAgY29uc3QgcGJSZXNwID0gYXdhaXQgdGhpcy5jbGllbnQuc3VnZ2VzdEdhc1ByaWNlKHBiUmVxLCB7XG4gICAgICBkZWFkbGluZTogdGhpcy5nZXREZWFkbGluZSgpXG4gICAgfSk7XG4gICAgcmV0dXJuIFN1Z2dlc3RHYXNQcmljZVJlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGVzdGltYXRlR2FzRm9yQWN0aW9uKFxuICAgIHJlcTogSUVzdGltYXRlR2FzRm9yQWN0aW9uUmVxdWVzdFxuICApOiBQcm9taXNlPElFc3RpbWF0ZUdhc0ZvckFjdGlvblJlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBFc3RpbWF0ZUdhc0ZvckFjdGlvblJlcXVlc3QudG8ocmVxKTtcbiAgICBjb25zdCBwYlJlc3AgPSBhd2FpdCB0aGlzLmNsaWVudC5lc3RpbWF0ZUdhc0ZvckFjdGlvbihwYlJlcSwge1xuICAgICAgZGVhZGxpbmU6IHRoaXMuZ2V0RGVhZGxpbmUoKVxuICAgIH0pO1xuICAgIHJldHVybiBFc3RpbWF0ZUdhc0ZvckFjdGlvblJlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHJlYWRTdGF0ZShyZXE6IElSZWFkU3RhdGVSZXF1ZXN0KTogUHJvbWlzZTxJUmVhZFN0YXRlUmVzcG9uc2U+IHtcbiAgICBjb25zdCBwYlJlcSA9IFJlYWRTdGF0ZVJlcXVlc3QudG8ocmVxKTtcbiAgICBjb25zdCBwYlJlc3AgPSBhd2FpdCB0aGlzLmNsaWVudC5yZWFkU3RhdGUocGJSZXEsIHtcbiAgICAgIGRlYWRsaW5lOiB0aGlzLmdldERlYWRsaW5lKClcbiAgICB9KTtcbiAgICByZXR1cm4gUmVhZFN0YXRlUmVxdWVzdC5mcm9tKHBiUmVzcCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgcmVhZENvbnRyYWN0KFxuICAgIHJlcTogSVJlYWRDb250cmFjdFJlcXVlc3RcbiAgKTogUHJvbWlzZTxJUmVhZENvbnRyYWN0UmVzcG9uc2U+IHtcbiAgICBjb25zdCBwYlJlcSA9IFJlYWRDb250cmFjdFJlcXVlc3QudG8ocmVxKTtcbiAgICBjb25zdCBwYlJlc3AgPSBhd2FpdCB0aGlzLmNsaWVudC5yZWFkQ29udHJhY3QocGJSZXEsIHtcbiAgICAgIGRlYWRsaW5lOiB0aGlzLmdldERlYWRsaW5lKClcbiAgICB9KTtcbiAgICByZXR1cm4gUmVhZENvbnRyYWN0UmVxdWVzdC5mcm9tKHBiUmVzcCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2VuZEFjdGlvbihcbiAgICByZXE6IElTZW5kQWN0aW9uUmVxdWVzdFxuICApOiBQcm9taXNlPElTZW5kQWN0aW9uUmVzcG9uc2U+IHtcbiAgICBjb25zdCBwYlJlcSA9IFNlbmRBY3Rpb25SZXF1ZXN0LnRvKHJlcSk7XG4gICAgY29uc3QgcGJSZXNwID0gYXdhaXQgdGhpcy5jbGllbnQuc2VuZEFjdGlvbihwYlJlcSwge1xuICAgICAgZGVhZGxpbmU6IHRoaXMuZ2V0RGVhZGxpbmUoKVxuICAgIH0pO1xuICAgIHJldHVybiBTZW5kQWN0aW9uUmVzcG9uc2UuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldFJlY2VpcHRCeUFjdGlvbihcbiAgICByZXE6IElHZXRSZWNlaXB0QnlBY3Rpb25SZXF1ZXN0XG4gICk6IFByb21pc2U8SUdldFJlY2VpcHRCeUFjdGlvblJlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBHZXRSZWNlaXB0QnlBY3Rpb25SZXF1ZXN0LnRvKHJlcSk7XG4gICAgY29uc3QgcGJSZXNwID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0UmVjZWlwdEJ5QWN0aW9uKHBiUmVxLCB7XG4gICAgICBkZWFkbGluZTogdGhpcy5nZXREZWFkbGluZSgpXG4gICAgfSk7XG4gICAgcmV0dXJuIEdldFJlY2VpcHRCeUFjdGlvblJlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldEVwb2NoTWV0YShcbiAgICByZXE6IElHZXRFcG9jaE1ldGFSZXF1ZXN0XG4gICk6IFByb21pc2U8SUdldEVwb2NoTWV0YVJlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBHZXRFcG9jaE1ldGFSZXF1ZXN0LnRvKHJlcSk7XG4gICAgY29uc3QgcGJSZXNwID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0RXBvY2hNZXRhKHBiUmVxLCB7XG4gICAgICBkZWFkbGluZTogdGhpcy5nZXREZWFkbGluZSgpXG4gICAgfSk7XG4gICAgcmV0dXJuIEdldEVwb2NoTWV0YVJlcXVlc3QuZnJvbShwYlJlc3ApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldExvZ3MocmVxOiBJR2V0TG9nc1JlcXVlc3QpOiBQcm9taXNlPElHZXRMb2dzUmVzcG9uc2U+IHtcbiAgICBjb25zdCBwYlJlcSA9IEdldExvZ3NSZXF1ZXN0LnRvKHJlcSk7XG4gICAgY29uc3QgcGJSZXNwID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0TG9ncyhwYlJlcSwge1xuICAgICAgZGVhZGxpbmU6IHRoaXMuZ2V0RGVhZGxpbmUoKVxuICAgIH0pO1xuICAgIHJldHVybiBHZXRMb2dzUmVxdWVzdC5mcm9tKHBiUmVzcCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZXN0aW1hdGVBY3Rpb25HYXNDb25zdW1wdGlvbihcbiAgICByZXE6IElFc3RpbWF0ZUFjdGlvbkdhc0NvbnN1bXB0aW9uUmVxdWVzdFxuICApOiBQcm9taXNlPElFc3RpbWF0ZUFjdGlvbkdhc0NvbnN1bXB0aW9uUmVzcG9uc2U+IHtcbiAgICBjb25zdCBwYlJlcSA9IEVzdGltYXRlQWN0aW9uR2FzQ29uc3VtcHRpb25SZXF1ZXN0LnRvKHJlcSk7XG4gICAgY29uc3QgcGJSZXNwID0gYXdhaXQgdGhpcy5jbGllbnQuZXN0aW1hdGVBY3Rpb25HYXNDb25zdW1wdGlvbihwYlJlcSwge1xuICAgICAgZGVhZGxpbmU6IHRoaXMuZ2V0RGVhZGxpbmUoKVxuICAgIH0pO1xuICAgIHJldHVybiBFc3RpbWF0ZUFjdGlvbkdhc0NvbnN1bXB0aW9uUmVxdWVzdC5mcm9tKHBiUmVzcCk7XG4gIH1cblxuICBwdWJsaWMgc3RyZWFtQmxvY2tzKFxuICAgIHJlcTogSVN0cmVhbUJsb2Nrc1JlcXVlc3RcbiAgKTogQ2xpZW50UmVhZGFibGVTdHJlYW08SVN0cmVhbUJsb2Nrc1Jlc3BvbnNlPiB7XG4gICAgY29uc3QgcGJSZXEgPSBTdHJlYW1CbG9ja3NSZXF1ZXN0LnRvKHJlcSk7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IG9yaWdpbiA9IHRoaXMuY2xpZW50LnN0cmVhbUJsb2NrcyhwYlJlcSwge1xuICAgICAgZGVhZGxpbmU6IHRoaXMuZ2V0RGVhZGxpbmUoKVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIG5ldyBDbGllbnRSZWFkYWJsZVN0cmVhbShvcmlnaW4sIFwiU3RyZWFtQmxvY2tzXCIpO1xuICB9XG5cbiAgcHVibGljIHN0cmVhbUxvZ3MoXG4gICAgcmVxOiBJU3RyZWFtTG9nc1JlcXVlc3RcbiAgKTogQ2xpZW50UmVhZGFibGVTdHJlYW08SVN0cmVhbUxvZ3NSZXNwb25zZT4ge1xuICAgIGNvbnN0IHBiUmVxID0gU3RyZWFtTG9nc1JlcXVlc3QudG8ocmVxKTtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3Qgb3JpZ2luID0gdGhpcy5jbGllbnQuc3RyZWFtTG9ncyhwYlJlcSwge1xuICAgICAgZGVhZGxpbmU6IHRoaXMuZ2V0RGVhZGxpbmUoKVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIG5ldyBDbGllbnRSZWFkYWJsZVN0cmVhbShvcmlnaW4sIFwiU3RyZWFtTG9nc1wiKTtcbiAgfVxufVxuIl19